<%#
 Copyright (C) 2017 Jian Chang <aa65535@live.com>
 Modified By Xingwang Liao <kuoruan@gmail.com> 2017-06-21
 Licensed to the public under the GNU General Public License v3.
-%>

<% include("cbi/map") %>

<script type="text/javascript">//<![CDATA[
	(function() {
		var _redir_status = document.getElementById('_redir_status'),
			_local_status = document.getElementById('_local_status'),
			_tunnel_status = document.getElementById('_tunnel_status');
		XHR.poll(5, '<%= luci.dispatcher.build_url("admin", "services", "shadowsocks", "status") %>', null, function(x, status) {
			if (_redir_status) {
				if (status.ss_redir || status.ssr_redir) {
					_redir_status.textContent = '<%:RUNNING%>'
				} else {
					_redir_status.textContent = '<%:NOT RUNNING%>'
				}
			}

			if (_local_status) {
				if (status.ss_local || status.ssr_local) {
					_local_status.textContent = '<%:RUNNING%>'
				} else {
					_local_status.textContent = '<%:NOT RUNNING%>'
				}
			}

			if (_tunnel_status) {
				if (status.ss_tunnel || status.ssr_tunnel) {
					_tunnel_status.textContent = '<%:RUNNING%>'
				} else {
					_tunnel_status.textContent = '<%:NOT RUNNING%>'
				}
			}
		});
	}());
//]]></script>
